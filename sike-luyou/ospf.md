# OSPF

在了解ospf之前，先了解下内部网关协议(Interior Gateway Protocol，简称IGP)。既然是内部网关协议，路由间信息传递也是作用在大环境下的局域网范围内。IGP设计重点是针对路由的学习与交换，发现路由等，它对于路由条目的存储量是有限的（ospf最多容纳1w条路由），仅在AS内部实现路由信息的交换。

IGP又被分为两类：距离矢量路由协议和链路状态路由协议。

* 距离[矢量](https://zhidao.baidu.com/question/71933083.html)路由协议：这类协议采用**距离向量算法来决定**报文交换的路径。
* [链路](https://baike.baidu.com/item/%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF/7181323)状态路由协议：收集网络或该限定区域内的所有路由器信息，并且可算出每台路由器各自到达目的地的最优路径。

> 参考自 [BGP与IGP之间的区别](http://www.voidcn.com/article/p-ojocvzvo-tx.html)、[百度百科-距离矢量路由协议](https://baike.baidu.com/item/%E9%93%BE%E8%B7%AF%E7%8A%B6%E6%80%81%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE)

OSPF(Open Shortest Path First开放式最短路径优先），用于在单一自治系统（autonomous system,AS）内决策路由。是对链路状态路由协议的一种实现，隶属内部网关协议（IGP）。整个作业流程使用了五种报文、三个阶段、四张表。

## ospf作业流程

五种报文
* Hello报文：建立并维护邻居关系。
* DBD报文：发送链路状态头部信息。
* LSR报文：把从DBD中找出需要的链路状态头部信息传给邻居，请求完整信息。
* LSU报文：将LSR请求的头部信息对应的完整信息发给邻居。
* LSACK：收到LSU报文后确认该报文。

三个阶段
1. 邻居发现：通过发送Hello报文形成邻居关系。 
1. 路由通告：邻居间发送链路状态信息形成邻接关系。 
1. 路由计算：根据最短路径算法算出路由表。 

四张表

|表|作用
|:-:|:-:
|邻居表|主要记录形成邻居关系路由器
|链路状态数据库|记录链路状态信息 
|OSPF路由表|通过链路状态数据库得出 
|全局路由表|OSPF路由与其他比较得出

ospf了解自身链路，寻找邻居并与其他路由器建立邻居关系后，路由器就可以创建链路状态数据包将描述链路状态的LSA泛洪到邻居，最终形成包含网络完整链路状态信息的链路状态数据库，路由区域内的每台路由器使用SPF算法来独立计算各个路由的最优路径并传输数据信息。

> 摘抄自[百度百科-组播扩展](https://baike.baidu.com/item/组播扩展OSPF)并参考 [晴刃-OSPF协议详解](https://www.qingsword.com/qing/596.html)

## OSPF协议主要优点



缺点也要有


写作思路

* 先用《趣学ccna》的方式作为导读
* 说明IGP与BGP的区别
* 百度百科
* 配置
